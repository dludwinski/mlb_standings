html_node('#standings-upto-AL-overall') %>%
html_table()
AL_standing_tmp$year<-year
AL_standing_tmp$month<-month
AL_standing_tmp$day<-day
View(AL_standing_all)
View(AL_standing_tmp)
StartDate<-as.Date('2017-09-01')
StartDate+1
StartDate+2
StartDate<-as.Date('2022-04-01')
EndDate<-as.Date('2023-10-04')
iDate<-StartDate
StartDate<-as.Date('2022-04-01')
EndDate<-as.Date('2022-05-04')
#as.Date('2023-10-04')
iDate<-StartDate
while (iDate<EndDate){
iDate<-iDate+1
iDate
}
iDate<EndDate
iDate
EndDate
iDate
print(iDate)
StartDate<-as.Date('2022-04-01')
EndDate<-as.Date('2022-05-04')
#as.Date('2023-10-04')
iDate<-StartDate
while (iDate<EndDate){
iDate<-iDate+1
print(iDate)
}
AL_standing_all<-AL_standing_all[0,]
AL_standing_all
source("~/.active-rstudio-document", echo=TRUE)
format(iDate,"%m")
format(iDate,"%Y")
format(iDate,"%d")
AL_standing_all<-AL_standing_all[0,]
StartDate<-as.Date('2022-04-01')
EndDate<-as.Date('2022-05-04')
#as.Date('2023-10-04')
iDate<-StartDate
while (iDate<EndDate){
iDate<-iDate+1
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
AL_standing_tmp$year<-year
AL_standing_tmp$month<-month
AL_standing_tmp$day<-day
#Insert dupcheck here
AL_standing_all <-rbind(AL_standing_all, AL_standing_tmp)
}
showConnections()
close(link)
showConnections(all = TRUE)
showConnections()
uri %>%
get_connections %>%
walk(link)
AL_standing_all<-AL_standing_all[0,]
StartDate<-as.Date('2022-04-01')
EndDate<-as.Date('2022-05-04')
#as.Date('2023-10-04')
iDate<-StartDate
while (iDate<EndDate){
iDate<-iDate+1
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
AL_standing_tmp$year<-year
AL_standing_tmp$month<-month
AL_standing_tmp$day<-day
#Insert dupcheck here
AL_standing_all <-rbind(AL_standing_all, AL_standing_tmp)
}
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
link
closeAllConnections()
br_page <- read_html(link)
read_html(link)
link
showConnections()
1
shiny::runApp('mlb_ranks')
runApp('mlb_ranks')
StartDate<-as.Date('2023-04-07')
install.packages("rvest")
library(rvest)
require(httr)
library(sqldf)
require(ggplot2)
AL_standing_all<-AL_standing_all[0,]
NL_standing_all<-NL_standing_all[0,]
AL_standing_all<-AL_standing_all[0,]
NL_standing_all<-NL_standing_all[0,]
NL_standing_all<-AL_standing_all[0,]
AL_standing_tmp<-AL_standing_tmp[0,]
NL_standing_tmp<-NL_standing_tmp[0,]
NL_standing_tmp<-AL_standing_tmp[0,]
NL_standing_tmp<-NL_standing_tmp[0,]
Standings_raw<-AL_standing_tmp[0,]
StartDate<-as.Date('2023-04-07')
EndDate<-Sys.Date()
iDate<-StartDate
while (iDate<EndDate){
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
if (nrow(Standings_raw[Standings_raw$date==iDate,])==0){
Sys.sleep(1)
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
NL_standing_tmp <- br_page %>%
html_node('#standings-upto-NL-overall') %>%
html_table()
AL_standing_tmp$date<-iDate
NL_standing_tmp$date<-iDate
#Insert dupcheck here
Standings_raw <-rbind(Standings_raw, AL_standing_tmp, NL_standing_tmp)
closeAllConnections()
}
iDate<-iDate+1
if (format(iDate,"%m") > 10) {
iDate<-iDate+150
}
gc()
closeAllConnections()
StartDate<-as.Date('2023-05-06')
#EndDate<-as.Date('2000-10-25')
EndDate<-Sys.Date()
iDate<-StartDate
while (iDate<EndDate){
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
if (nrow(Standings_raw[Standings_raw$date==iDate,])==0){
Sys.sleep(1)
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
NL_standing_tmp <- br_page %>%
html_node('#standings-upto-NL-overall') %>%
html_table()
AL_standing_tmp$date<-iDate
NL_standing_tmp$date<-iDate
#Insert dupcheck here
Standings_raw <-rbind(Standings_raw, AL_standing_tmp, NL_standing_tmp)
closeAllConnections()
}
iDate<-iDate+1
if (format(iDate,"%m") > 10) {
iDate<-iDate+150
}
StartDate<-as.Date('2023-05-06')
#EndDate<-as.Date('2000-10-25')
EndDate<-Sys.Date()
iDate<-StartDate
while (iDate<EndDate){
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
if (nrow(Standings_raw[Standings_raw$date==iDate,])==0){
Sys.sleep(1.5)
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
NL_standing_tmp <- br_page %>%
html_node('#standings-upto-NL-overall') %>%
html_table()
AL_standing_tmp$date<-iDate
NL_standing_tmp$date<-iDate
#Insert dupcheck here
Standings_raw <-rbind(Standings_raw, AL_standing_tmp, NL_standing_tmp)
closeAllConnections()
}
iDate<-iDate+1
if (format(iDate,"%m") > 10) {
iDate<-iDate+150
}
gc()
closeAllConnections()
All_standings_staging<-Standings_raw
All_standings_staging$Division<-""
All_standings_staging$Current_Name<-""
All_standings_staging$Year<-as.numeric(format(All_standings_staging$date,"%Y"))
All_standings_staging$Games<-All_standings_staging$W+All_standings_staging$L
All_standings_staging$Year<-as.numeric(format(All_standings_staging$date,"%Y"))
#Add Spread
All_standings_staging$spread<-All_standings_staging$W-All_standings_staging$L
#Current Names
All_standings_staging$Current_Name<-All_standings_staging$Tm
All_standings_staging[All_standings_staging$Tm=="MON",]$Current_Name<-"WSN"
All_standings_staging[All_standings_staging$Tm=="FLA",]$Current_Name<-"MIA"
All_standings_staging[All_standings_staging$Tm=="CAL",]$Current_Name<-"LAA"
All_standings_staging[All_standings_staging$Tm=="ANA",]$Current_Name<-"LAA"
All_standings_staging[All_standings_staging$Tm=="TBD",]$Current_Name<-"TBR"
#Divisions
#https://en.wikipedia.org/wiki/Timeline_of_Major_League_Baseball
#Old Divisions (1969-1994)
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("WSN", "CHC", "STL", "PIT","NYM", "PHI"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("CIN", "ATL", "LAD", "SFG", "HOU", "SDP"),]$Division <- "NL West"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("MIL","BAL", "BOS", "NYY", "TOR", "CLE", "DET"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("MIN", "KCR", "CHW", "TEX",  "SEA", "OAK", "LAA"),]$Division <- "AL West"
#Division 1994-
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("BAL", "BOS", "NYY", "TOR", "DET"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("CLE", "KCR", "CHW", "MIN", "MIL"),]$Division <- "AL Central"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("TEX", "HOU", "SEA", "LAA", "OAK"),]$Division <- "AL West"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("WSN", "NYM", "MIA", "PHI", "ATL"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("CHC", "STL", "PIT", "CIN"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("LAD", "SFG", "COL", "ARI", "SDP"),]$Division <- "NL West"
#Division Nov 1997:Milwaukee Brewers moved from the AL to the NL Central
#Division Nov 1997:Detroit Tigers moved from the AL East to the AL Central
All_standings_staging[All_standings_staging$Year>=1998 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("MIL"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=1998 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("DET"),]$Division <- "AL Central"
#Division 1998: Expansion teams
All_standings_staging[All_standings_staging$Current_Name %in% c("TBR"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Current_Name %in% c("ARI"),]$Division <- "AL West"
# Current divisions (2013-???): Houston moved
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("BAL", "BOS", "NYY", "TBR", "TOR"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("CLE", "DET", "KCR", "CHW", "MIN"),]$Division <- "AL Central"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("TEX", "HOU", "SEA", "LAA", "OAK"),]$Division <- "AL West"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("WSN", "NYM", "MIA", "PHI", "ATL"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("CHC", "STL", "PIT", "MIL", "CIN"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("LAD", "SFG", "COL", "ARI", "SDP"),]$Division <- "NL West"
#Team colors
TeamColors<-read.csv("TeamColors.csv")
All_standings_staging<-sqldf("SELECT All_standings_staging.*, HexColor
FROM All_standings_staging
LEFT OUTER JOIN TeamColors
on Team = All_standings_staging.Current_Name
")
All_standings_staging$HexColor<-paste0("#",All_standings_staging$HexColor)
#Fix endpoints
#All_standings_bckup<-All_standings
iyear<-1990
while (iyear<=2022){
season_start<-min(All_standings_staging[All_standings_staging$W>1 & All_standings_staging$Year==iyear,]$date)-1
season_games<-max(All_standings_staging[All_standings_staging$Year==iyear,]$Games)
season_end<-min( All_standings_staging[All_standings_staging$Year==iyear & All_standings_staging$Games == season_games,]$date    )+1
All_standings_staging <- subset(All_standings_staging, Year != iyear | (date>=season_start & date<=season_end ))
iyear<-iyear+1
}
warning()
warnings()
iyear<-1990
while (iyear<=2022){
season_start<-min(All_standings_staging[All_standings_staging$W>1 & All_standings_staging$Year==iyear,]$date)-1
season_games<-max(All_standings_staging[All_standings_staging$Year==iyear,]$Games)
season_end<-min( All_standings_staging[All_standings_staging$Year==iyear & All_standings_staging$Games == season_games,]$date    )+1
All_standings_staging <- subset(All_standings_staging, Year != iyear | (date>=season_start & date<=season_end ))
iyear<-iyear+1
}
warnings()
View(All_standings_staging)
All_standings<-rbind(All_standings,All_standings_staging)
All_standings <- readRDS(url("https://github.com/dludwinski/mlb_standings/blob/main/All_standings.RDS?raw=true"))
All_standings<-rbind(All_standings,All_standings_staging)
All_standings2 <- All_standings[!duplicated(All_standings), ]
All_standings <- All_standings[!duplicated(All_standings), ]
saveRDS(All_standings, file = "All_standings.RDS")
plot_temp<-All_standings[All_standings$Division==Division & All_standings$Year>2022,]
View(All_standings)
Division <- "AL East"
plot_temp<-All_standings[All_standings$Division==Division & All_standings$Year>2022,]
team_division_colors<-sqldf("SELECT distinct Tm, HexColor, Max(W) as MaxW from plot_temp group by Tm")
team_division_colors<-team_division_colors[order(-team_division_colors$MaxW),]
grph_plot_title <- paste0("Net wins by date: ",Division ,", ",year)
par(mar = c(5, 5, 5, 10), xpd=TRUE )
plot(plot_temp$date, plot_temp$spread
, main= grph_plot_title, cex.main = 2.5
, pch = 16
, col=plot_temp$HexColor
, cex.lab = 1.7, xlab="Date", ylab="Net Wins"
#, plot.window(xlim=c(season_start,season_end), ylim=c(-80,80), xaxs="i", yaxs="i") #
#, cex.axis	= 1.1
#    , log="x"
)
All_standings<-sqldf("SELECT All_standings.*, HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
View(All_standings)
All_standings2<-sqldf("SELECT Tm, W, L, `W-L%`, GB, RS, RA, `pythW-L%`, date, spread, Division, Games, Year, Current_Name, HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
All_standings2<-sqldf("SELECT Tm, W, L, `W-L%`, GB, RS, RA, `pythW-L%`, date, spread, All_standings.Division, Games, Year, Current_Name, HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
All_standings2<-sqldf("SELECT Tm, W, L, `W-L%`, GB, RS, RA, `pythW-L%`, date, spread, All_standings.Division, Games, Year, Current_Name, TeamColors.HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
All_standings$HexColor<-paste0("#",All_standings$HexColor)
All_standings<-sqldf("SELECT Tm, W, L, `W-L%`, GB, RS, RA, `pythW-L%`, date, spread, All_standings.Division, Games, Year, Current_Name, TeamColors.HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
All_standings$HexColor<-paste0("#",All_standings$HexColor)
rm(All_standings2)
year <- 2006
Division <- "AL East"
plot_temp<-All_standings[All_standings$Division==Division & All_standings$Year>2022,]
team_division_colors<-sqldf("SELECT distinct Tm, HexColor, Max(W) as MaxW from plot_temp group by Tm")
team_division_colors<-team_division_colors[order(-team_division_colors$MaxW),]
grph_plot_title <- paste0("Net wins by date: ",Division ,", ",year)
par(mar = c(5, 5, 5, 10), xpd=TRUE )
plot(plot_temp$date, plot_temp$spread
, main= grph_plot_title, cex.main = 2.5
, pch = 16
, col=plot_temp$HexColor
, cex.lab = 1.7, xlab="Date", ylab="Net Wins"
#, plot.window(xlim=c(season_start,season_end), ylim=c(-80,80), xaxs="i", yaxs="i") #
#, cex.axis	= 1.1
#    , log="x"
)
View(team_division_colors)
View(TeamColors)
All_standings<-sqldf("SELECT Tm, W, L, `W-L%`, GB, RS, RA, `pythW-L%`, date, spread, All_standings.Division, Games, Year, Current_Name, TeamColors.HexColor
FROM All_standings
LEFT OUTER JOIN TeamColors
on Team = All_standings.Current_Name
")
year <- 2006
Division <- "AL East"
plot_temp<-All_standings[All_standings$Division==Division & All_standings$Year>2022,]
team_division_colors<-sqldf("SELECT distinct Tm, HexColor, Max(W) as MaxW from plot_temp group by Tm")
team_division_colors<-team_division_colors[order(-team_division_colors$MaxW),]
grph_plot_title <- paste0("Net wins by date: ",Division ,", ",year)
par(mar = c(5, 5, 5, 10), xpd=TRUE )
plot(plot_temp$date, plot_temp$spread
, main= grph_plot_title, cex.main = 2.5
, pch = 16
, col=plot_temp$HexColor
, cex.lab = 1.7, xlab="Date", ylab="Net Wins"
#, plot.window(xlim=c(season_start,season_end), ylim=c(-80,80), xaxs="i", yaxs="i") #
#, cex.axis	= 1.1
#    , log="x"
)
#grid(nx = NULL, ny = NULL, col = "lightgray", lty = 1,lwd = par("lwd"), equilogs = FALSE)
legend("topright", inset=c(-0.10, .15)
#grph_min_date, 40
, legend = team_division_colors[,"Tm"]
, col=team_division_colors[,"HexColor"]
, lty=1, lwd=8, cex=1.3
,box.lty=1)
saveRDS(All_standings, file = "All_standings.RDS")
shiny::runApp('mlb_ranks')
StartDate<- max(All_standings$date)
StartDate
StartDate<- max(All_standings$date)+1
StartDate
StartDate<- max(All_standings$date)+1
#EndDate<-as.Date('2000-10-25')
EndDate<-Sys.Date()
iDate<-StartDate
while (iDate<EndDate){
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
if (nrow(Standings_raw[Standings_raw$date==iDate,])==0){
Sys.sleep(1.5)
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
NL_standing_tmp <- br_page %>%
html_node('#standings-upto-NL-overall') %>%
html_table()
AL_standing_tmp$date<-iDate
NL_standing_tmp$date<-iDate
#Insert dupcheck here
Standings_raw <-rbind(Standings_raw, AL_standing_tmp, NL_standing_tmp)
closeAllConnections()
}
iDate<-iDate+1
if (format(iDate,"%m") > 10) {
iDate<-iDate+150
}
#install.packages("rvest")
library(rvest)
require(httr)
library(sqldf)
require(ggplot2)
standings <- readRDS(url("https://github.com/dludwinski/mlb_standings/blob/main/All_standings.RDS?raw=true"))
AL_standing_tmp<-AL_standing_tmp[0,]
NL_standing_tmp<-NL_standing_tmp[0,]
Standings_raw<-AL_standing_tmp[0,]
#last run 2023-05-10
#StartDate<-as.Date('2023-05-06')
StartDate<- max(All_standings$date)+1
#EndDate<-as.Date('2000-10-25')
EndDate<-Sys.Date()
iDate<-StartDate
while (iDate<EndDate){
print(iDate)
year=format(iDate,"%Y")
month=format(iDate,"%m")
day=format(iDate,"%d")
if (nrow(Standings_raw[Standings_raw$date==iDate,])==0){
Sys.sleep(1.5)
link <- paste0("https://www.baseball-reference.com/boxes/?year=",year,"&month=",month,"&day=",day)
br_page <- read_html(link)
AL_standing_tmp <- br_page %>%
html_node('#standings-upto-AL-overall') %>%
html_table()
NL_standing_tmp <- br_page %>%
html_node('#standings-upto-NL-overall') %>%
html_table()
AL_standing_tmp$date<-iDate
NL_standing_tmp$date<-iDate
#Insert dupcheck here
Standings_raw <-rbind(Standings_raw, AL_standing_tmp, NL_standing_tmp)
closeAllConnections()
}
iDate<-iDate+1
if (format(iDate,"%m") > 10) {
iDate<-iDate+150
}
gc()
closeAllConnections()
All_standings_staging<-Standings_raw
All_standings_staging$Division<-""
All_standings_staging$Current_Name<-""
All_standings_staging$Year<-as.numeric(format(All_standings_staging$date,"%Y"))
All_standings_staging$Games<-All_standings_staging$W+All_standings_staging$L
All_standings_staging$Year<-as.numeric(format(All_standings_staging$date,"%Y"))
#Add Spread
All_standings_staging$spread<-All_standings_staging$W-All_standings_staging$L
#Current Names
All_standings_staging$Current_Name<-All_standings_staging$Tm
All_standings_staging[All_standings_staging$Tm=="MON",]$Current_Name<-"WSN"
All_standings_staging[All_standings_staging$Tm=="FLA",]$Current_Name<-"MIA"
All_standings_staging[All_standings_staging$Tm=="CAL",]$Current_Name<-"LAA"
All_standings_staging[All_standings_staging$Tm=="ANA",]$Current_Name<-"LAA"
All_standings_staging[All_standings_staging$Tm=="TBD",]$Current_Name<-"TBR"
#Divisions
#https://en.wikipedia.org/wiki/Timeline_of_Major_League_Baseball
#Old Divisions (1969-1994)
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("WSN", "CHC", "STL", "PIT","NYM", "PHI"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("CIN", "ATL", "LAD", "SFG", "HOU", "SDP"),]$Division <- "NL West"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("MIL","BAL", "BOS", "NYY", "TOR", "CLE", "DET"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year<1994 & All_standings_staging$Current_Name %in% c("MIN", "KCR", "CHW", "TEX",  "SEA", "OAK", "LAA"),]$Division <- "AL West"
#Division 1994-
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("BAL", "BOS", "NYY", "TOR", "DET"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("CLE", "KCR", "CHW", "MIN", "MIL"),]$Division <- "AL Central"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("TEX", "HOU", "SEA", "LAA", "OAK"),]$Division <- "AL West"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("WSN", "NYM", "MIA", "PHI", "ATL"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("CHC", "STL", "PIT", "CIN"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=1994 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("LAD", "SFG", "COL", "ARI", "SDP"),]$Division <- "NL West"
#Division Nov 1997:Milwaukee Brewers moved from the AL to the NL Central
#Division Nov 1997:Detroit Tigers moved from the AL East to the AL Central
All_standings_staging[All_standings_staging$Year>=1998 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("MIL"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=1998 & All_standings_staging$Year<2013 & All_standings_staging$Current_Name %in% c("DET"),]$Division <- "AL Central"
#Division 1998: Expansion teams
All_standings_staging[All_standings_staging$Current_Name %in% c("TBR"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Current_Name %in% c("ARI"),]$Division <- "AL West"
# Current divisions (2013-???): Houston moved
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("BAL", "BOS", "NYY", "TBR", "TOR"),]$Division <- "AL East"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("CLE", "DET", "KCR", "CHW", "MIN"),]$Division <- "AL Central"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("TEX", "HOU", "SEA", "LAA", "OAK"),]$Division <- "AL West"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("WSN", "NYM", "MIA", "PHI", "ATL"),]$Division <- "NL East"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("CHC", "STL", "PIT", "MIL", "CIN"),]$Division <- "NL Central"
All_standings_staging[All_standings_staging$Year>=2013 & All_standings_staging$Current_Name %in% c("LAD", "SFG", "COL", "ARI", "SDP"),]$Division <- "NL West"
#Team colors
TeamColors<-read.csv("TeamColors.csv")
All_standings_staging<-sqldf("SELECT All_standings_staging.*, HexColor
FROM All_standings_staging
LEFT OUTER JOIN TeamColors
on Team = All_standings_staging.Current_Name
")
All_standings<-rbind(All_standings,All_standings_staging)
All_standings <- All_standings[!duplicated(All_standings), ]
saveRDS(All_standings, file = "All_standings.RDS")
